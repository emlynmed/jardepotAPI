function verifyCookie(){void 0!==Cookies.get("session")&&""!==Cookies.get("session")||$.ajax({url:ruta+"api/session",type:"GET",dataType:"json",success:function(e){Cookies.set("session",e,{expires:7})},error:function(e){console.log(e)}})}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(document).ready(function(){history.forward(1)&&history.replace(history.forward(1)),window.location.hash="no-back",window.location.hash="Again-No-back-button",window.onhashchange=function(){window.location.hash="no-back"},$("body").on("contextmenu",function(e){return!1}),$('[data-toggle="tooltip"]').tooltip(),getCartProducts()}),$("#search-form").on("keypress",function(e){13==e.which&&$("#search-form").submit()}),$(".search-form").submit(function(e){e.preventDefault();var o=$(this).find(".inputSearch").val();window.location=ruta+"busqueda/"+o});var bussy=!1;function ajaxCall(e){bussy?setTimeout(function(){ajaxCall(e)},500):($("#overlay-bussy").addClass("active"),e.data._token=$('meta[name="csrf-token"]').attr("content"),bussy=!0,e.dataType=void 0===e.dataType||null==e.dataType?"text":e.dataType,$.ajax({url:e.url,type:e.type,dataType:e.dataType,data:e.data,success:e.success,error:function(o){$("#overlay-bussy").removeClass("active"),console.log(o),alert("Ocurrio un error "+e.url,"Error")},complete:function(){$("#overlay-bussy").removeClass("active"),"undefined"===(e.complete,!1)&&null==!e.complete&&e.complete(),bussy=!1}}))}function releaseAjaxQueue(){bussy=!1}function blockAjaxQueue(){bussy=!0}function executeAfterAjaxRelease(e){bussy?setTimeout(function(){executeAfterAjaxRelease(e)},500):e()}function getCookie(e){let o="undefined"!=typeof document?document:null;if(o){let t,a=o.cookie.split(";"),s=a.length,n=`${e}=`;for(let e=0;e<s;e+=1)if(0==(t=a[e].replace(/^\s+/g,"")).indexOf(n))return t.substring(n.length,t.length);return""}return""}function deleteCookie(e){this.setCookie(e,"",-1)}function setCookie(e,o,t,a=""){let s="undefined"!=typeof document?document:null;if(s){let n=new Date;n.setTime(n.getTime()+24*t*60*60*1e3);let r=`expires=${n.toUTCString()}`,i=a?`; path=${a}`:"";s.cookie=`${e}=${o}; ${r}${i}`}}function verifyAddCartProduct(e,o,t,a,s){void 0===Cookies.get("session")||""===Cookies.get("session")?$.ajax({url:ruta+"api/session",type:"GET",dataType:"json",success:function(n){Cookies.set("session",n,{expires:7}),addCartProduct(e,o,t,a,s)},error:function(e){console.log(e)}}):addCartProduct(e,o,t,a,s)}function addCartProduct(e,o,t,a,s){var n={productType:e,brand:o,mpn:t};$("#overlay-bussy").addClass("active"),$.ajax({url:ruta+"api/cart/addProduct",type:"POST",dataType:"json",data:{product:JSON.stringify(n),quantity:a,sessionCookie:Cookies.get("session")},success:function(n){"successful"===n.data&&($("#overlay-bussy").removeClass("active"),getCartProducts(),openSnackbar("success","Agregaste "+a+" "+e+" "+o+" "+t),"cart"===s?window.location=ruta+"cart":"mercado"===s&&($("#table-body").html(""),getCartProductsView(),$("#modalMercadoPago").modal("show")))},error:function(e){$("#overlay-bussy").removeClass("active"),console.log(e)}})}function decreaseCartProduct(e,o,t,a){var s={productType:e,brand:o,mpn:t};verifyCookie(),$("#overlay-bussy").addClass("active"),$.ajax({url:ruta+"api/cart/addProduct",type:"POST",dataType:"json",data:{product:JSON.stringify(s),quantity:a,sessionCookie:Cookies.get("session")},success:function(s){"successful"===s.data&&(getCartProducts(),openSnackbar("danger","Quitaste "+(a*=-1)+" "+e+" "+o+" "+t)),$("#overlay-bussy").removeClass("active")},error:function(e){$("#overlay-bussy").removeClass("active")}})}function removeCartProduct(e){void 0!==Cookies.get("session")&&""!==Cookies.get("session")&&($("#overlay-bussy").addClass("active"),$.ajax({url:ruta+"api/cart/removeProduct",type:"DELETE",dataType:"json",data:{product:e,sessionCookie:Cookies.get("session")},success:function(o){"successful"===o.data&&(getCartProducts(),openSnackbar("danger","Eliminaste "+e)),$("#overlay-bussy").removeClass("active")},error:function(e){$("#overlay-bussy").removeClass("active")}}))}function getCartProducts(){if($("#option-dropdown-cart1").hide(),$("#option-dropdown-cart2").hide(),void 0!==Cookies.get("session")&&""!==Cookies.get("session"))$.ajax({url:ruta+"api/cart/products",type:"GET",dataType:"json",data:{sessionCookie:Cookies.get("session")},success:function(e){if(e){var o=JSON.parse(e);makeDropdownCart(o.cart,o.total,o.quantityProducts)}else Cookies.remove("session")},error:function(e){}});else{$("#option-dropdown-cart1").hide(),$("#option-dropdown-cart2").hide(),$("#items-count-nav1").html("0"),$("#products-coun-nav1").html("0 Productos"),$("#items-count-nav2").html("0"),$("#products-coun-nav2").html("0 Productos");var e='<div class="dropdown-item">   <div class="text-muted mt-1">       <span style="white-space: pre-line"><b>No tienes ningún producto en tu carrito.</b></span>   </div></div>';$("#items-card-nav1").html(e),$("#items-card-nav2").html(e)}}function makeDropdownCart(e,o,t){if(t>0){$("#option-dropdown-cart1").show(),$("#option-dropdown-cart2").show(),$("#items-count-nav1").html(t),$("#products-coun-nav1").html(t+" Productos"),$("#items-count-nav2").html(t),$("#products-coun-nav2").html(t+" Productos");var a="";$.each(e,function(e,o){a+=' <div class="dropdown-item">     <div class="row">         <div class="col-10">              <p class="text-muted mat-line" data-toggle="tooltip" title="'+o.name+'">'+o.name+'</p>              <p class="text-muted mat-line">'+o.cartCount+" x "+formatterDolar.format(o.newPrice)+'</p>         </div>         <div class="col-2">             <button class="btn" type="button" data-toggle="tooltip"  title="Eliminar"                   onclick="removeCartProduct(\''+o.name+'\')"><i class="material-icons">close</i></button>         </div>     </div>  </div>'}),a+='   <div class="dropdown-divider"></div><div class="dropdown-item">   <div class="text-muted mt-1"><b>TOTAL: '+formatterDolar.format(o)+'</b></div></div><div class="dropdown-divider"></div>',$("#items-card-nav1").html(a),$("#items-card-nav2").html(a)}else{$("#option-dropdown-cart1").hide(),$("#option-dropdown-cart2").hide(),$("#items-count-nav1").html("0"),$("#products-coun-nav1").html("0 Productos"),$("#items-count-nav2").html("0"),$("#products-coun-nav2").html("0 Productos");a='<div class="dropdown-item">   <div class="text-muted mt-1">       <span style="white-space: pre-line"><b>No tienes ningún producto en tu carrito.</b></span>   </div></div>';$("#items-card-nav1").html(a),$("#items-card-nav2").html(a)}}const formatterDolar=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});function openSnackbar(e,o){var t;switch(e){case"success":t="#218838";break;case"warning":t="#f68600";break;case"danger":t="#dc3545";break;case"info":t="#17a2b8";break;case"primary":t="#0069d9";break;default:t="#333"}var a=document.getElementById("snackbar");$("#snackbar").css("background-color",t),$("#snackbar").html("<p>"+o+"</p>"),a.className="show",setTimeout(function(){a.className=a.className.replace("show","")},3e3)}function removeAllProducts(){(void 0!==Cookies.get("session")&&""!==Cookies.get("session")||"undefined"!==Cookies.get("session"))&&$.ajax({url:ruta+"api/cart/removeAllProducts",type:"DELETE",dataType:"json",data:{sessionCookie:Cookies.get("session")},success:function(e){"successful"===e.data&&(getCartProducts(),openSnackbar("success","Se limpió el carrito")),$("#overlay-bussy").removeClass("active")},error:function(e){$("#overlay-bussy").removeClass("active")}})}function topPage(){const e=-window.pageYOffset/10,o=setInterval(()=>{0!==window.pageYOffset?this.window.scrollBy(0,e):clearInterval(o)},10)}$(document).ready(function(){navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&-1==navigator.userAgent.indexOf("CriOS")&&-1==navigator.userAgent.indexOf("FxiOS")?window.innerWidth<960?($("#banner1").addClass("banner1-mob-safari"),$("#banner2").addClass("banner2-mob-safari"),$("#banner3").addClass("banner3-mob-safari")):($("#banner1").addClass("banner1-safari"),$("#banner2").addClass("banner2-safari"),$("#banner3").addClass("banner3-safari")):window.innerWidth<960?($("#banner1").addClass("banner1-mob"),$("#banner2").addClass("banner2-mob"),$("#banner3").addClass("banner3-mob")):($("#banner1").addClass("banner1"),$("#banner2").addClass("banner2"),$("#banner3").addClass("banner3"))});
