function verifyCookie(){void 0!==Cookies.get("session")&&""!==Cookies.get("session")||$.ajax({url:ruta+"api/session",type:"GET",dataType:"json",success:function(t){Cookies.set("session",t,{expires:7})},error:function(t){console.log(t)}})}function showMenuCart(){$(".overlayMenuCart").css("display","block"),$("body").css("overflow","hidden")}function closeMenuCart(){$("body").css("overflow","scroll"),$(".overlayMenuCart").css("display","none")}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(document).ready(function(){if($("body").on("contextmenu",function(t){return!1}),$('[data-toggle="tooltip"]').tooltip(),getCartProducts(),$(".buy-now-menu").click(function(t){verifyAddCartProduct($("#current-product").data("producttype"),$("#current-product").data("brand"),$("#current-product").data("mpn"),1,"cart"),closeMenuCart(),t.stopPropagation()}),$(".add-cart-menu").click(function(t){verifyAddCartProduct($("#current-product").data("producttype"),$("#current-product").data("brand"),$("#current-product").data("mpn"),1,""),closeMenuCart(),t.stopPropagation()}),$(".btn-side-cart").click(function(){showMenuCart()}),$(".overlayMenuCart").click(function(){closeMenuCart()}),""!==window.location.hash){var t=window.location.origin+window.location.pathname;history.pushState(null,"",t)}}),$("#search-form").on("keypress",function(t){13==t.which&&$("#search-form").submit()}),$(".search-form").submit(function(t){t.preventDefault();var e=$(this).find(".inputSearch").val(),o="["+e+"]";e=e.split(" ").join("-"),e+=o,window.location=ruta+"busqueda/"+e});var bussy=!1;function ajaxCall(t){bussy?setTimeout(function(){ajaxCall(t)},500):($("#overlay-bussy").addClass("active"),t.data._token=$('meta[name="csrf-token"]').attr("content"),bussy=!0,t.dataType=void 0===t.dataType||null==t.dataType?"text":t.dataType,$.ajax({url:t.url,type:t.type,dataType:t.dataType,data:t.data,success:t.success,error:function(e){$("#overlay-bussy").removeClass("active"),console.log(e),alert("Ocurrio un error "+t.url,"Error")},complete:function(){$("#overlay-bussy").removeClass("active"),"undefined"===(t.complete,!1)&&null==!t.complete&&t.complete(),bussy=!1}}))}function releaseAjaxQueue(){bussy=!1}function blockAjaxQueue(){bussy=!0}function executeAfterAjaxRelease(t){bussy?setTimeout(function(){executeAfterAjaxRelease(t)},500):t()}function getCookie(t){let e="undefined"!=typeof document?document:null;if(e){let o,s=e.cookie.split(";"),a=s.length,n=`${t}=`;for(let t=0;t<a;t+=1)if(0==(o=s[t].replace(/^\s+/g,"")).indexOf(n))return o.substring(n.length,o.length);return""}return""}function deleteCookie(t){this.setCookie(t,"",-1)}function setCookie(t,e,o,s=""){let a="undefined"!=typeof document?document:null;if(a){let n=new Date;n.setTime(n.getTime()+24*o*60*60*1e3);let r=`expires=${n.toUTCString()}`,i=s?`; path=${s}`:"";a.cookie=`${t}=${e}; ${r}${i}`}}function verifyAddCartProduct(t,e,o,s,a){void 0===Cookies.get("session")||""===Cookies.get("session")?$.ajax({url:ruta+"api/session",type:"GET",dataType:"json",success:function(n){Cookies.set("session",n,{expires:7}),addCartProduct(t,e,o,s,a)},error:function(t){console.log(t)}}):addCartProduct(t,e,o,s,a)}function addCartProduct(t,e,o,s,a){var n={productType:t,brand:e,mpn:o};$("#overlay-bussy").addClass("active"),$.ajax({url:ruta+"api/cart/addProduct",type:"POST",dataType:"json",data:{product:JSON.stringify(n),quantity:s,sessionCookie:Cookies.get("session")},success:function(n){"successful"===n.data&&($("#overlay-bussy").removeClass("active"),getCartProducts(),openSnackbar("success","Agregaste "+s+" "+t+" "+e+" "+o),"cart"===a?window.location=ruta+"cart":"mercado"===a&&($("#table-body").html(""),getCartProductsView(),$("#modalMercadoPago").modal("show")))},error:function(t){$("#overlay-bussy").removeClass("active"),console.log(t)}})}function decreaseCartProduct(t,e,o,s){var a={productType:t,brand:e,mpn:o};verifyCookie(),$("#overlay-bussy").addClass("active"),$.ajax({url:ruta+"api/cart/addProduct",type:"POST",dataType:"json",data:{product:JSON.stringify(a),quantity:s,sessionCookie:Cookies.get("session")},success:function(a){"successful"===a.data&&(getCartProducts(),openSnackbar("danger","Quitaste "+(s*=-1)+" "+t+" "+e+" "+o)),$("#overlay-bussy").removeClass("active")},error:function(t){$("#overlay-bussy").removeClass("active")}})}function removeCartProduct(t){void 0!==Cookies.get("session")&&""!==Cookies.get("session")&&($("#overlay-bussy").addClass("active"),$.ajax({url:ruta+"api/cart/removeProduct",type:"DELETE",dataType:"json",data:{product:t,sessionCookie:Cookies.get("session")},success:function(e){"successful"===e.data&&(getCartProducts(),openSnackbar("danger","Eliminaste "+t)),$("#overlay-bussy").removeClass("active")},error:function(t){$("#overlay-bussy").removeClass("active")}}))}function getCartProducts(){if($("#option-dropdown-cart1").hide(),$("#option-dropdown-cart2").hide(),void 0!==Cookies.get("session")&&""!==Cookies.get("session"))$.ajax({url:ruta+"api/cart/products",type:"GET",dataType:"json",data:{sessionCookie:Cookies.get("session")},success:function(t){if(t){var e=JSON.parse(t);makeDropdownCart(e.cart,e.total,e.quantityProducts),$("#cart-count-side").text(e.quantityProducts)}else Cookies.remove("session")},error:function(t){}});else{$("#option-dropdown-cart1").hide(),$("#option-dropdown-cart2").hide(),$("#items-count-nav1").html("0"),$("#products-coun-nav1").html("0 Productos"),$("#items-count-nav2").html("0"),$("#products-coun-nav2").html("0 Productos");var t='<div class="dropdown-item">   <div class="text-muted mt-1">       <span style="white-space: pre-line"><b>No tienes ningún producto en tu carrito.</b></span>   </div></div>';$("#items-card-nav1").html(t),$("#items-card-nav2").html(t)}}function makeDropdownCart(t,e,o){if(o>0){$("#option-dropdown-cart1").show(),$("#option-dropdown-cart2").show(),$("#items-count-nav1").html(o),$("#products-coun-nav1").html(o+" Productos"),$("#items-count-nav2").html(o),$("#products-coun-nav2").html(o+" Productos");var s="";$.each(t,function(t,e){s+=' <div class="dropdown-item">     <div class="row">         <div class="col-10">              <p class="text-muted mat-line" data-toggle="tooltip" title="'+e.name+'">'+e.name+'</p>              <p class="text-muted mat-line">'+e.cartCount+" x "+formatterDolar.format(e.newPrice)+'</p>         </div>         <div class="col-2">             <button class="btn" type="button" data-toggle="tooltip"  title="Eliminar"                   onclick="removeCartProduct(\''+e.name+'\')"><i class="material-icons">close</i></button>         </div>     </div>  </div>'}),s+='   <div class="dropdown-divider"></div><div class="dropdown-item">   <div class="text-muted mt-1"><b>TOTAL: '+formatterDolar.format(e)+'</b></div></div><div class="dropdown-divider"></div>',$("#items-card-nav1").html(s),$("#items-card-nav2").html(s)}else{$("#option-dropdown-cart1").hide(),$("#option-dropdown-cart2").hide(),$("#items-count-nav1").html("0"),$("#products-coun-nav1").html("0 Productos"),$("#items-count-nav2").html("0"),$("#products-coun-nav2").html("0 Productos");s='<div class="dropdown-item">   <div class="text-muted mt-1">       <span style="white-space: pre-line"><b>No tienes ningún producto en tu carrito.</b></span>   </div></div>';$("#items-card-nav1").html(s),$("#items-card-nav2").html(s)}}const formatterDolar=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});function openSnackbar(t,e){var o;switch(t){case"success":o="#218838";break;case"warning":o="#f68600";break;case"danger":o="#dc3545";break;case"info":o="#17a2b8";break;case"primary":o="#0069d9";break;default:o="#333"}var s=document.getElementById("snackbar");$("#snackbar").css("background-color",o),$("#snackbar").html("<p>"+e+"</p>"),s.className="show",setTimeout(function(){s.className=s.className.replace("show","")},3e3)}function removeAllProducts(){(void 0!==Cookies.get("session")&&""!==Cookies.get("session")||"undefined"!==Cookies.get("session"))&&$.ajax({url:ruta+"api/cart/removeAllProducts",type:"DELETE",dataType:"json",data:{sessionCookie:Cookies.get("session")},success:function(t){"successful"===t.data&&(getCartProducts(),openSnackbar("success","Se limpió el carrito")),$("#overlay-bussy").removeClass("active")},error:function(t){$("#overlay-bussy").removeClass("active")}})}function topPage(){const t=-window.pageYOffset/10,e=setInterval(()=>{0!==window.pageYOffset?this.window.scrollBy(0,t):clearInterval(e)},10)}$(document).ready(function(){window.innerWidth<960?($(".movil").each(function(t,e){0==t&&$(this).addClass("active"),$(this).find("img").attr("src",$(this).find("img").data("src"))}),$(".desktop").remove()):($(".desktop").each(function(t,e){0==t&&$(this).addClass("active"),$(this).find("img").attr("src",$(this).find("img").data("src"))}),$(".movil").remove()),$("#carouselBanners").carousel()});
